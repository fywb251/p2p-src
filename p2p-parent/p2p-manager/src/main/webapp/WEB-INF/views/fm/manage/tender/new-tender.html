<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>和融网管理平台</title>
<meta name="keywords" content="和融网管理平台">
<link href="${b.staticPath}style/style.css" rel="stylesheet" type="text/css" />
<script src="${b.staticPath}js/jquery1.8.js"></script>
<script src="${b.staticPath}js/datepicker.js"></script>
<script src="${b.staticPath}js/jquery.paginate.js"></script>
<@b.validate/>
<@b.dialog/>
<script>
var validform;
$(document).ready(function() {
	validform = $("#submit_form").Validform({
		tiptype : 3,
		datatype:{
			minAmount : function(gets){
				//参数gets是获取到的表单元素值，obj为当前表单元素，curform为当前验证的表单，regxp为内置的一些正则表达式的引用;
	 				var amount = $("#amount").val();
					if(amount%gets != 0){
						return "输入的最小金额必须能被投资金额整除！";
					}else if(gets > amount){
						return "输入的最小金额不能比投资金额大！";
					}
				//注意return可以返回true 或 false 或 字符串文字，true表示验证通过，返回字符串表示验证失败，字符串作为错误提示显示，返回false则用errmsg或默认的错误提示;
			},
			maxAmount : function(gets){
				//参数gets是获取到的表单元素值，obj为当前表单元素，curform为当前验证的表单，regxp为内置的一些正则表达式的引用;
	 				var amount = $("#amount").val();
	 				var minNum = $("#minAmount").val();
					if(amount%gets != 0){
						return "输入的最大金额必须能被投资金额整除！";
					}else if(gets < minNum){
						return "输入的最大金额必须比最小金额大！";
					}else if(gets > amount){
						return "输入的最大金额不能比投资金额大！";
					}else if(gets % minNum != 0){
						return "输入的最大金额必须是最小投资金额倍数！";
					}
				//注意return可以返回true 或 false 或 字符串文字，true表示验证通过，返回字符串表示验证失败，字符串作为错误提示显示，返回false则用errmsg或默认的错误提示;
			}
		}
	});

});
function saveApply() {
	if (!validform.check()) {
		return false;
	}
	var amount = $("#amount").val();
	var minNum = $("#minAmount").val();
	var maxNum = $("#maxAmount").val();
	if(amount.length>15){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("借款金额太大，请重新输入。");
		success.showModal();
		return false;
	}
	if(minNum.length>15){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("最小投资金额太大，请重新输入。");
		success.showModal();
		return false;
	}
	if(maxNum.length>15){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("最大投资金额太大，请重新输入。");
		success.showModal();
		return false;
	}
	if(minNum>amount){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("最小投资金额不能高于借款金额。");
		success.showModal();
		return false;
	}
	if(maxNum>amount){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("最大投资金额不能高于借款金额。");
		success.showModal();
		return false;
	}
	if(minNum>maxNum){
		var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
			}
		});
		success.content("最大投资金额太小。");
		success.showModal();
		return false;
	}
	 var success = dialog({
			title : '消息',
			cancel : false,
			ok : function() {
				window.location.href = "${basePath}tender/tenderList.htm";
			}
		});
		var show = dialog();
		var d = dialog({
			title : '消息',
			content : '是否提交借款标记录?',
			okValue : '确 定',
			ok : function() {
				var that = this;
				show.showModal();
				$.post("${basePath}tender/edit.htm", $("#submit_form").serialize(), function(
						data) {
					if (data.isOK == 'ok') {
						show.close().remove();
						success.content('提交借款标成功！');
						success.showModal();
					} else {
						success.content(data.isOK);
						success.showModal();
					}
				})
			},
			cancelValue : '取消',
			cancel : function() {
			}
		});
		d.showModal();
}
</script>
</head>
<body>
<div id="header" class="fence">
  <@b.header />
</div>
<div class="fence">
  <div class="fence-wide pt10 pb10 ly-clearFix">
    <@b.leftMenu />
    <div class="yard-1000 ly-left">
      <div class="rightSide">
        <div class="heading fontYH f20">生成投资标书</div>
        <div class="mainBox">
        <form id="submit_form">
          <table border="0" cellspacing="0" cellpadding="0" class=" tabTender">
            <col width="20%" />
            <col width="80%" />
            <tr>
              <th>标题</th>
              <td><input type="text" name="title" id="title" autocomplete="off"
								placeholder="" value="${info.title}" datatype="*1-20"
								errormsg="请输入1~20位之间的字符！" nullmsg="请输入标题！" class="input input-w270h30"/></td>
            </tr>
            <tr>
              <th>借款人</th>
              <td>
              <input type="hidden" name="customerId" value="${applyId}"/>
              <input type="hidden" name="id" value="${info.debtId}" />
              <input type="hidden" name="status" value="${info.status}" />
              <input type="text" name="name" id="name" value="${name}" readonly="readonly" class="input input-w270h30"/></td>
            </tr>
            <tr>
              <th>还款类型</th>
              <td><select name="repayType" id="repayType" class="c_select">
              <#list repaymentList as repayment>
           <#if (repayment.value==info.repayType)>
            	<option value="${repayment.value}" selected="selected">${repayment.text}</option>
            	<#else>
            	<option value="${repayment.value}">${repayment.text}</option>
            	</#if>
            </#list>
              </select></td>
            </tr>
            <tr>
              <th>借款期限</th>
              <td>
              <select name="months" id="months" title="借款成功后,打算以几个月的时间来还清贷款。" class="c_select x_select">
              <#list 0..11 as i>
　　　　　　　　 <#if (i+1)==info.months >
　　　　　　　　　　　 　<option value="${i+1}" selected="selected">${i+1}个月</option>
				<#else>
				<option value="${i+1}">${i+1}个月</option>
　　　　　　　　　</#if>
　　　		</#list>
              </select>
              </td>
            </tr>
            <tr>
              <th>年化利率</th>
              <td><input type="text" name="annualizedRate" id="annualizedRate" autocomplete="off"
								placeholder="" value="${info.annualizedRate}" datatype="/^((100|[1-9]?\d)(\.\d{0,2})?)$/"
								errormsg="请输入一百以内最多两位小数的数字！" nullmsg="请输入年化利率！" class="input input-w270h30"/> %</td>
            </tr>
            <tr>
              <th>借款金额</th>
              <td><input type="text" name="amount" id="amount" value="${info.amount}" datatype="/^\d{1,15}$/"
								errormsg="请输入不超过十五位的整数！" nullmsg="请输入借款金额！" id="borrowingAmount" class="input input-w270h30"/>元</td>
            </tr>
            <tr>
              <th>最小投资金额</th>
              <td><input type="text" name="minInvest" value="${info.minInvest}" id="minAmount" datatype="minAmount /^\d{1,15}$/"
								errormsg="请输入不超过十五位的整数！" nullmsg="请输入最小投资金额！" class="input input-w270h30"/>元</td>
            </tr>
            <tr>
              <th>最大投资金额</th>
              <td><input type="text" name="maxInvest" value="${info.maxInvest}" id="maxAmount" datatype="maxAmount /^\d{1,15}$/"
								errormsg="请输入不超过十五位的整数！" nullmsg="请输入最大投资金额！" class="input input-w270h30"/>元</td>
            </tr>
            
          </table>
          <div class="tc mt20 mb20"><a href="javascript:void(0)" onclick="saveApply();" class="button button-orange">确认生成</a></div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="footer" class="fence">
  <div class="fence-wide">&copy; 2015 南京紫金财富企业管理有限公司&nbsp;版权所有<span class="ml10"><a href="http://www.miitbeian.gov.cn/" target="_blank">苏ICP备14047993号-1</a></span></div>
</div>
<div class="modal-wrap popDemo remList" style="display:none;">
      <div class="modal-header"><span class="close">关闭</span></div>
     <div class="modal-body memberBox" title="优先显示通过UnionID匹配到的员工编号，如果没有的情况下显示UnionID">
       <div class="item fontYH color-blue">第一度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第二度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第三度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第四度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
	   <div class="item fontYH color-blue">第五度推荐 ：<span title="陈绍伟">oO_eAjtxCKoRnicolAYtKcx3cu8c</span></div>
  </div>
  </div>
<div class="modal-wrap popDemo memLevel" style="display:none;">
  <div class="modal-header"><span class="close">关闭</span></div>
  <div class="modal-body memberBox">
    <div class="item fontYH color-blue">客户分级 :
      <select name="select4" id="select4" class="fontYH">
                <option>新客户</option>
                <option>准客户</option>
                <option>大客户</option>
                <option>VIP客户</option>
              </select>
    </div>
    <button class="popBtn">确认</button>
  </div>
</div>
<div class="modal-wrap popDemo memberList" style="display:none;">
      <div class="modal-header"><span class="close">关闭</span></div>
     <div class="modal-body memberBox">
       <div class="item fontYH color-blue">
         归属员工 :<input name="" type="text" class="input input-w220h30 ml5 fontYH" title="联想输入员工编号" value="请输入员工编号" /> </div>
  <button class="popBtn">确认</button></div>
  </div>
<div class="maskdivgen" style="display:none"></div>
<script type="text/javascript">
		$(function() {
			$("#pager").paginate({
				count 		: 50,
				start 		: 1,
				display     : 10,
				border					: true,
				border_color			: '#CCC',
				text_color  			: '#333',
				background_color    	: '',	
				border_hover_color		: '#ff4400',
				text_hover_color  		: '',
				background_hover_color	: '', 
				images					: false,
				mouse					: 'press'
			});
});
		</script>
</body>
</html>
